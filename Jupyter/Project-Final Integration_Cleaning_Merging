{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "2cdf467e-d82f-4113-a5af-a5ce3a57fee1",
   "metadata": {},
   "source": [
    "# Project Proposal Data Scraping/Cleaning/CSV Files\n",
    "Alex Mueggenberg and Sebastian Rios"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "12f5eebd-86b3-408b-9241-8782e7e458f0",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "9f236111-9d1e-4c53-9ffb-3f5d66336db2",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Teams in player data: ['Arsenal' 'Aston Villa' 'Brentford' 'Brighton & Hove Albion' 'Burnley'\n",
      " 'Chelsea' 'Crystal Palace' 'Everton' 'Leeds United' 'Leicester City'\n",
      " 'Liverpool' 'Manchester City' 'Manchester United' 'Newcastle United'\n",
      " 'Norwich City' 'Southampton' 'Tottenham Hotspur' 'Watford'\n",
      " 'West Ham United' 'Wolverhampton Wanderers']\n",
      "Teams in team data: ['Manchester City' 'Liverpool' 'Chelsea' 'Tottenham Hotspur' 'Arsenal'\n",
      " 'Manchester United' 'West Ham United' 'Leicester City'\n",
      " 'Brighton And Hove Albion' 'Wolverhampton Wanderers' 'Newcastle United'\n",
      " 'Crystal Palace' 'Brentford' 'Aston Villa' 'Southampton' 'Everton'\n",
      " 'Leeds United' 'Burnley' 'Watford' 'Norwich City']\n",
      "✅ Merged dataset saved as 'merged_player_team_stats.csv'\n"
     ]
    }
   ],
   "source": [
    "premier_league_csv_df = pd.read_csv(\"Football Players Stats (Premier League 2021-2022).csv\", encoding='ISO-8859-1')  # or utf-8 if it works\n",
    "teams_df = pd.read_csv(\"premier_league_table.csv\")\n",
    "\n",
    "print(\"Teams in player data:\", premier_league_csv_df['Team'].unique())\n",
    "print(\"Teams in team data:\", teams_df['Team'].unique())\n",
    "\n",
    "premier_league_csv_df['Team'] = premier_league_csv_df['Team'].str.strip()\n",
    "teams_df['Team'] = teams_df['Team'].str.strip()\n",
    "\n",
    "merged_df = pd.merge(premier_league_csv_df, teams_df, on='Team', how='left')\n",
    "\n",
    "merged_df.to_csv(\"merged_player_team_stats.csv\", index=False)\n",
    "print(\"Merged dataset saved as 'merged_player_team_stats.csv'\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "id": "018a251b-f0a9-41bf-9b8d-b8d1d3ecbea7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Reading in the file\n",
    "premier_league_csv_df = pd.read_csv('Football Players Stats (Premier League 2021-2022).csv', encoding='ISO-8859-1', delimiter=',')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "id": "8dc07a69-58d9-4a3e-8bb6-5f9c9c97b2ac",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Team</th>\n",
       "      <th>Nation</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Age</th>\n",
       "      <th>MP</th>\n",
       "      <th>Starts</th>\n",
       "      <th>Min</th>\n",
       "      <th>90s</th>\n",
       "      <th>Gls</th>\n",
       "      <th>...</th>\n",
       "      <th>npxG.1</th>\n",
       "      <th>npxG+xA.1</th>\n",
       "      <th>Played</th>\n",
       "      <th>Won</th>\n",
       "      <th>Drawn</th>\n",
       "      <th>Lost</th>\n",
       "      <th>Goals For</th>\n",
       "      <th>Goals Against</th>\n",
       "      <th>Goal Difference</th>\n",
       "      <th>Points</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Bukayo Saka</td>\n",
       "      <td>Arsenal</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>FW,MF</td>\n",
       "      <td>19.0</td>\n",
       "      <td>38</td>\n",
       "      <td>36</td>\n",
       "      <td>2,978</td>\n",
       "      <td>33.1</td>\n",
       "      <td>11.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.25</td>\n",
       "      <td>0.46</td>\n",
       "      <td>38.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>69.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Gabriel Dos Santos</td>\n",
       "      <td>Arsenal</td>\n",
       "      <td>br BRA</td>\n",
       "      <td>DF</td>\n",
       "      <td>23.0</td>\n",
       "      <td>35</td>\n",
       "      <td>35</td>\n",
       "      <td>3,063</td>\n",
       "      <td>34.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.10</td>\n",
       "      <td>38.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>69.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Aaron Ramsdale</td>\n",
       "      <td>Arsenal</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>GK</td>\n",
       "      <td>23.0</td>\n",
       "      <td>34</td>\n",
       "      <td>34</td>\n",
       "      <td>3,060</td>\n",
       "      <td>34.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>38.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>69.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Ben White</td>\n",
       "      <td>Arsenal</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>DF</td>\n",
       "      <td>23.0</td>\n",
       "      <td>32</td>\n",
       "      <td>32</td>\n",
       "      <td>2,880</td>\n",
       "      <td>32.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.05</td>\n",
       "      <td>38.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>69.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Martin Ødegaard</td>\n",
       "      <td>Arsenal</td>\n",
       "      <td>no NOR</td>\n",
       "      <td>MF</td>\n",
       "      <td>22.0</td>\n",
       "      <td>36</td>\n",
       "      <td>32</td>\n",
       "      <td>2,785</td>\n",
       "      <td>30.9</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.16</td>\n",
       "      <td>0.38</td>\n",
       "      <td>38.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>69.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>686</th>\n",
       "      <td>Christian Marques</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>ch SUI</td>\n",
       "      <td>DF</td>\n",
       "      <td>18.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>51.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>687</th>\n",
       "      <td>Yerson Mosquera</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>co COL</td>\n",
       "      <td>DF</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>51.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>688</th>\n",
       "      <td>Louie Moulden</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>GK</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>51.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>689</th>\n",
       "      <td>Dion Sanderson</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>DF</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>51.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>690</th>\n",
       "      <td>James Storer</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>GK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>51.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>691 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 Player                     Team   Nation    Pos   Age  MP  \\\n",
       "0           Bukayo Saka                  Arsenal  eng ENG  FW,MF  19.0  38   \n",
       "1    Gabriel Dos Santos                  Arsenal   br BRA     DF  23.0  35   \n",
       "2        Aaron Ramsdale                  Arsenal  eng ENG     GK  23.0  34   \n",
       "3             Ben White                  Arsenal  eng ENG     DF  23.0  32   \n",
       "4       Martin Ødegaard                  Arsenal   no NOR     MF  22.0  36   \n",
       "..                  ...                      ...      ...    ...   ...  ..   \n",
       "686   Christian Marques  Wolverhampton Wanderers   ch SUI     DF  18.0   0   \n",
       "687     Yerson Mosquera  Wolverhampton Wanderers   co COL     DF  20.0   0   \n",
       "688       Louie Moulden  Wolverhampton Wanderers  eng ENG     GK  19.0   0   \n",
       "689      Dion Sanderson  Wolverhampton Wanderers  eng ENG     DF  21.0   0   \n",
       "690        James Storer  Wolverhampton Wanderers      NaN     GK   NaN   0   \n",
       "\n",
       "     Starts    Min   90s   Gls  ...  npxG.1  npxG+xA.1  Played   Won  Drawn  \\\n",
       "0        36  2,978  33.1  11.0  ...    0.25       0.46    38.0  22.0    3.0   \n",
       "1        35  3,063  34.0   5.0  ...    0.08       0.10    38.0  22.0    3.0   \n",
       "2        34  3,060  34.0   0.0  ...    0.00       0.00    38.0  22.0    3.0   \n",
       "3        32  2,880  32.0   0.0  ...    0.03       0.05    38.0  22.0    3.0   \n",
       "4        32  2,785  30.9   7.0  ...    0.16       0.38    38.0  22.0    3.0   \n",
       "..      ...    ...   ...   ...  ...     ...        ...     ...   ...    ...   \n",
       "686       0    NaN   NaN   NaN  ...     NaN        NaN    38.0  15.0    6.0   \n",
       "687       0    NaN   NaN   NaN  ...     NaN        NaN    38.0  15.0    6.0   \n",
       "688       0    NaN   NaN   NaN  ...     NaN        NaN    38.0  15.0    6.0   \n",
       "689       0    NaN   NaN   NaN  ...     NaN        NaN    38.0  15.0    6.0   \n",
       "690       0    NaN   NaN   NaN  ...     NaN        NaN    38.0  15.0    6.0   \n",
       "\n",
       "     Lost  Goals For  Goals Against  Goal Difference  Points  \n",
       "0    13.0       61.0           48.0             13.0    69.0  \n",
       "1    13.0       61.0           48.0             13.0    69.0  \n",
       "2    13.0       61.0           48.0             13.0    69.0  \n",
       "3    13.0       61.0           48.0             13.0    69.0  \n",
       "4    13.0       61.0           48.0             13.0    69.0  \n",
       "..    ...        ...            ...              ...     ...  \n",
       "686  17.0       38.0           43.0             -5.0    51.0  \n",
       "687  17.0       38.0           43.0             -5.0    51.0  \n",
       "688  17.0       38.0           43.0             -5.0    51.0  \n",
       "689  17.0       38.0           43.0             -5.0    51.0  \n",
       "690  17.0       38.0           43.0             -5.0    51.0  \n",
       "\n",
       "[691 rows x 38 columns]"
      ]
     },
     "execution_count": 157,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Merge Successful\n",
    "merged_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "e3c7f0c3-7bcd-45e4-a56c-ccb9c63e0222",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['Player', 'Team', 'Nation', 'Pos', 'Age', 'MP', 'Starts', 'Min', '90s', 'Gls', 'Ast', 'G-PK', 'PK', 'PKatt', 'CrdY', 'CrdR', 'Gls.1', 'Ast.1', 'G+A', 'G-PK.1', 'G+A-PK', 'xG', 'npxG', 'xA', 'npxG+xA', 'xG.1', 'xA.1', 'xG+xA', 'npxG.1', 'npxG+xA.1', 'Played', 'Won', 'Drawn', 'Lost', 'Goals For', 'Goals Against', 'Goal Difference', 'Points']\n"
     ]
    }
   ],
   "source": [
    "# Checking the lists to help create the data table\n",
    "print(merged_df.columns.tolist())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "d23b7ca3-7660-4fae-84c4-2a6d29b8fda5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Position</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Cristiano Ronaldo</td>\n",
       "      <td>£ 515,000</td>\n",
       "      <td>£ 28,599,424</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Kevin De Bruyne</td>\n",
       "      <td>£ 400,000</td>\n",
       "      <td>£ 22,213,145</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>David de Gea</td>\n",
       "      <td>£ 375,000</td>\n",
       "      <td>£ 20,824,824</td>\n",
       "      <td>K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Raphaël Varane</td>\n",
       "      <td>£ 340,000</td>\n",
       "      <td>£ 18,881,173</td>\n",
       "      <td>D</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Romelu Lukaku</td>\n",
       "      <td>£ 325,000</td>\n",
       "      <td>£ 18,048,180</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>470</th>\n",
       "      <td>Dan Burn</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>D</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>471</th>\n",
       "      <td>Zanka</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>D</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>472</th>\n",
       "      <td>Ashley Fletcher</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>473</th>\n",
       "      <td>Emmanuel Dennis</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>474</th>\n",
       "      <td>Ken Sema</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>M</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>475 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                Player Weekly Salary Annual Salary Position\n",
       "0    Cristiano Ronaldo     £ 515,000  £ 28,599,424        F\n",
       "1      Kevin De Bruyne     £ 400,000  £ 22,213,145        F\n",
       "2         David de Gea     £ 375,000  £ 20,824,824        K\n",
       "3       Raphaël Varane     £ 340,000  £ 18,881,173        D\n",
       "4        Romelu Lukaku     £ 325,000  £ 18,048,180        F\n",
       "..                 ...           ...           ...      ...\n",
       "470           Dan Burn      £ 15,000     £ 832,993        D\n",
       "471              Zanka      £ 15,000     £ 832,993        D\n",
       "472    Ashley Fletcher      £ 15,000     £ 832,993        F\n",
       "473    Emmanuel Dennis      £ 15,000     £ 832,993        F\n",
       "474           Ken Sema      £ 15,000     £ 832,993        M\n",
       "\n",
       "[475 rows x 4 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# This data was scraped and converted into a csv file\n",
    "finances = pd.read_csv('testing.csv')\n",
    "finances = finances.drop(columns=['Unnamed: 0'])\n",
    "display(finances)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "id": "e3573cc3-5052-49ab-8c2a-cc87ed3e6a4a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Position</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Cristiano Ronaldo</td>\n",
       "      <td>£ 515,000</td>\n",
       "      <td>£ 28,599,424</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Kevin De Bruyne</td>\n",
       "      <td>£ 400,000</td>\n",
       "      <td>£ 22,213,145</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>David de Gea</td>\n",
       "      <td>£ 375,000</td>\n",
       "      <td>£ 20,824,824</td>\n",
       "      <td>K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Raphaël Varane</td>\n",
       "      <td>£ 340,000</td>\n",
       "      <td>£ 18,881,173</td>\n",
       "      <td>D</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Romelu Lukaku</td>\n",
       "      <td>£ 325,000</td>\n",
       "      <td>£ 18,048,180</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>Ederson</td>\n",
       "      <td>£ 100,000</td>\n",
       "      <td>£ 5,553,286</td>\n",
       "      <td>K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>Antonio Rüdiger</td>\n",
       "      <td>£ 100,000</td>\n",
       "      <td>£ 5,553,286</td>\n",
       "      <td>D</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>Raúl Jiménez</td>\n",
       "      <td>£ 100,000</td>\n",
       "      <td>£ 5,553,286</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>Sead Kolasinac</td>\n",
       "      <td>£ 100,000</td>\n",
       "      <td>£ 5,553,286</td>\n",
       "      <td>D</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>Reece James</td>\n",
       "      <td>£ 100,000</td>\n",
       "      <td>£ 5,553,286</td>\n",
       "      <td>D</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               Player Weekly Salary Annual Salary Position\n",
       "0   Cristiano Ronaldo     £ 515,000  £ 28,599,424        F\n",
       "1     Kevin De Bruyne     £ 400,000  £ 22,213,145        F\n",
       "2        David de Gea     £ 375,000  £ 20,824,824        K\n",
       "3      Raphaël Varane     £ 340,000  £ 18,881,173        D\n",
       "4       Romelu Lukaku     £ 325,000  £ 18,048,180        F\n",
       "..                ...           ...           ...      ...\n",
       "95            Ederson     £ 100,000   £ 5,553,286        K\n",
       "96    Antonio Rüdiger     £ 100,000   £ 5,553,286        D\n",
       "97       Raúl Jiménez     £ 100,000   £ 5,553,286        F\n",
       "98     Sead Kolasinac     £ 100,000   £ 5,553,286        D\n",
       "99        Reece James     £ 100,000   £ 5,553,286        D\n",
       "\n",
       "[100 rows x 4 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Displaying the top 100(curiousity, no real purpose)\n",
    "top_100_players = finances.head(100)\n",
    "display(top_100_players)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "id": "b358b28c-77e3-40cb-9d53-c7fe0730fe16",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Position</th>\n",
       "      <th>Team</th>\n",
       "      <th>Nation</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Age</th>\n",
       "      <th>MP</th>\n",
       "      <th>Starts</th>\n",
       "      <th>...</th>\n",
       "      <th>npxG.1</th>\n",
       "      <th>npxG+xA.1</th>\n",
       "      <th>Played</th>\n",
       "      <th>Won</th>\n",
       "      <th>Drawn</th>\n",
       "      <th>Lost</th>\n",
       "      <th>Goals For</th>\n",
       "      <th>Goals Against</th>\n",
       "      <th>Goal Difference</th>\n",
       "      <th>Points</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Cristiano Ronaldo</td>\n",
       "      <td>£ 515,000</td>\n",
       "      <td>£ 28,599,424</td>\n",
       "      <td>F</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>pt POR</td>\n",
       "      <td>FW</td>\n",
       "      <td>36.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.52</td>\n",
       "      <td>0.64</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Kevin De Bruyne</td>\n",
       "      <td>£ 400,000</td>\n",
       "      <td>£ 22,213,145</td>\n",
       "      <td>F</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>MF</td>\n",
       "      <td>30.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.26</td>\n",
       "      <td>0.65</td>\n",
       "      <td>38.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>David de Gea</td>\n",
       "      <td>£ 375,000</td>\n",
       "      <td>£ 20,824,824</td>\n",
       "      <td>K</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>es ESP</td>\n",
       "      <td>GK</td>\n",
       "      <td>30.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Raphaël Varane</td>\n",
       "      <td>£ 340,000</td>\n",
       "      <td>£ 18,881,173</td>\n",
       "      <td>D</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>DF</td>\n",
       "      <td>28.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.05</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Romelu Lukaku</td>\n",
       "      <td>£ 325,000</td>\n",
       "      <td>£ 18,048,180</td>\n",
       "      <td>F</td>\n",
       "      <td>Chelsea</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>FW</td>\n",
       "      <td>28.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.34</td>\n",
       "      <td>0.51</td>\n",
       "      <td>38.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>74.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>490</th>\n",
       "      <td>Dan Burn</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>D</td>\n",
       "      <td>Newcastle United</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>DF</td>\n",
       "      <td>29.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.04</td>\n",
       "      <td>38.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>-18.0</td>\n",
       "      <td>49.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>491</th>\n",
       "      <td>Zanka</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>492</th>\n",
       "      <td>Ashley Fletcher</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>F</td>\n",
       "      <td>Watford</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>FW</td>\n",
       "      <td>25.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.16</td>\n",
       "      <td>1.16</td>\n",
       "      <td>38.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>493</th>\n",
       "      <td>Emmanuel Dennis</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>F</td>\n",
       "      <td>Watford</td>\n",
       "      <td>ng NGA</td>\n",
       "      <td>FW,MF</td>\n",
       "      <td>23.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.26</td>\n",
       "      <td>0.37</td>\n",
       "      <td>38.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>494</th>\n",
       "      <td>Ken Sema</td>\n",
       "      <td>£ 15,000</td>\n",
       "      <td>£ 832,993</td>\n",
       "      <td>M</td>\n",
       "      <td>Watford</td>\n",
       "      <td>se SWE</td>\n",
       "      <td>MF,FW</td>\n",
       "      <td>27.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.14</td>\n",
       "      <td>38.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>495 rows × 41 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                Player Weekly Salary Annual Salary Position  \\\n",
       "0    Cristiano Ronaldo     £ 515,000  £ 28,599,424        F   \n",
       "1      Kevin De Bruyne     £ 400,000  £ 22,213,145        F   \n",
       "2         David de Gea     £ 375,000  £ 20,824,824        K   \n",
       "3       Raphaël Varane     £ 340,000  £ 18,881,173        D   \n",
       "4        Romelu Lukaku     £ 325,000  £ 18,048,180        F   \n",
       "..                 ...           ...           ...      ...   \n",
       "490           Dan Burn      £ 15,000     £ 832,993        D   \n",
       "491              Zanka      £ 15,000     £ 832,993        D   \n",
       "492    Ashley Fletcher      £ 15,000     £ 832,993        F   \n",
       "493    Emmanuel Dennis      £ 15,000     £ 832,993        F   \n",
       "494           Ken Sema      £ 15,000     £ 832,993        M   \n",
       "\n",
       "                  Team   Nation    Pos   Age    MP  Starts  ... npxG.1  \\\n",
       "0    Manchester United   pt POR     FW  36.0  30.0    27.0  ...   0.52   \n",
       "1      Manchester City   be BEL     MF  30.0  30.0    25.0  ...   0.26   \n",
       "2    Manchester United   es ESP     GK  30.0  38.0    38.0  ...   0.00   \n",
       "3    Manchester United   fr FRA     DF  28.0  22.0    20.0  ...   0.04   \n",
       "4              Chelsea   be BEL     FW  28.0  26.0    16.0  ...   0.34   \n",
       "..                 ...      ...    ...   ...   ...     ...  ...    ...   \n",
       "490   Newcastle United  eng ENG     DF  29.0  16.0    16.0  ...   0.03   \n",
       "491                NaN      NaN    NaN   NaN   NaN     NaN  ...    NaN   \n",
       "492            Watford  eng ENG     FW  25.0   3.0     0.0  ...   1.16   \n",
       "493            Watford   ng NGA  FW,MF  23.0  33.0    30.0  ...   0.26   \n",
       "494            Watford   se SWE  MF,FW  27.0  18.0     7.0  ...   0.02   \n",
       "\n",
       "     npxG+xA.1  Played   Won  Drawn  Lost  Goals For  Goals Against  \\\n",
       "0         0.64    38.0  16.0   10.0  12.0       57.0           57.0   \n",
       "1         0.65    38.0  29.0    6.0   3.0       99.0           26.0   \n",
       "2         0.00    38.0  16.0   10.0  12.0       57.0           57.0   \n",
       "3         0.05    38.0  16.0   10.0  12.0       57.0           57.0   \n",
       "4         0.51    38.0  21.0   11.0   6.0       76.0           33.0   \n",
       "..         ...     ...   ...    ...   ...        ...            ...   \n",
       "490       0.04    38.0  13.0   10.0  15.0       44.0           62.0   \n",
       "491        NaN     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "492       1.16    38.0   6.0    5.0  27.0       34.0           77.0   \n",
       "493       0.37    38.0   6.0    5.0  27.0       34.0           77.0   \n",
       "494       0.14    38.0   6.0    5.0  27.0       34.0           77.0   \n",
       "\n",
       "     Goal Difference  Points  \n",
       "0                0.0    58.0  \n",
       "1               73.0    93.0  \n",
       "2                0.0    58.0  \n",
       "3                0.0    58.0  \n",
       "4               43.0    74.0  \n",
       "..               ...     ...  \n",
       "490            -18.0    49.0  \n",
       "491              NaN     NaN  \n",
       "492            -43.0    23.0  \n",
       "493            -43.0    23.0  \n",
       "494            -43.0    23.0  \n",
       "\n",
       "[495 rows x 41 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Merging of the dataset and creating the final dataframe\n",
    "merged_475 = pd.merge(finances, merged_df, on='Player', how='left')\n",
    "display(merged_475)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "id": "dcfea50a-3e3e-4169-8592-0620b9cc703d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['FW', 'MF', 'GK', 'DF', 'MF,FW', 'FW,MF', nan, 'MF,DF', 'DF,FW',\n",
       "       'FW,DF', 'DF,MF'], dtype=object)"
      ]
     },
     "execution_count": 162,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_475['Pos'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "id": "5dda3b6b-ee71-43d6-a275-25aba195b189",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Remove leading/trailing spaces\n",
    "merged_475.columns = merged_475.columns.str.strip() "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "id": "90799582-cc9c-453a-91dc-a0310854f628",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   Weekly Salary  Annual Salary\n",
      "0         515000       28599424\n",
      "1         400000       22213145\n",
      "2         375000       20824824\n",
      "3         340000       18881173\n",
      "4         325000       18048180\n"
     ]
    }
   ],
   "source": [
    "# Cleaning of the data due to constant errors within the code\n",
    "# Strip any leading/trailing whitespace and remove '£' and ',' symbols\n",
    "merged_475['Weekly Salary'] = merged_475['Weekly Salary'].str.strip().str.replace('£', '', regex=False).str.replace(',', '', regex=False)\n",
    "merged_475['Annual Salary'] = merged_475['Annual Salary'].str.strip().str.replace('£', '', regex=False).str.replace(',', '', regex=False)\n",
    "\n",
    "# Convert the columns to numeric values, setting invalid values to NaN\n",
    "merged_475['Weekly Salary'] = pd.to_numeric(merged_475['Weekly Salary'], errors='coerce')\n",
    "merged_475['Annual Salary'] = pd.to_numeric(merged_475['Annual Salary'], errors='coerce')\n",
    "\n",
    "# Check the first few rows after conversion\n",
    "print(merged_475[['Weekly Salary', 'Annual Salary']].head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "id": "5a416b2a-6163-41f9-9816-1dde9762191e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Convert relevant columns to numeric using .loc to avoid the warning\n",
    "dupes.loc[:, cols_to_numeric] = dupes[cols_to_numeric].apply(pd.to_numeric, errors='coerce')\n",
    "\n",
    "# Calculate performance score using .loc to avoid the warning\n",
    "dupes.loc[:, \"performance_score\"] = (\n",
    "    dupes[\"Min\"].fillna(0) +\n",
    "    dupes[\"Gls\"].fillna(0) * 100 +\n",
    "    dupes[\"Ast\"].fillna(0) * 50 +\n",
    "    dupes[\"npxG+xA.1\"].fillna(0) * 100\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "id": "5beabd58-e371-4533-8629-d793a3979682",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Team</th>\n",
       "      <th>Nation</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Age</th>\n",
       "      <th>MP</th>\n",
       "      <th>Starts</th>\n",
       "      <th>Min</th>\n",
       "      <th>...</th>\n",
       "      <th>npxG+xA.1</th>\n",
       "      <th>Played</th>\n",
       "      <th>Won</th>\n",
       "      <th>Drawn</th>\n",
       "      <th>Lost</th>\n",
       "      <th>Goals For</th>\n",
       "      <th>Goals Against</th>\n",
       "      <th>Goal Difference</th>\n",
       "      <th>Points</th>\n",
       "      <th>performance_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>76</th>\n",
       "      <td>Donny van de Beek</td>\n",
       "      <td>120000</td>\n",
       "      <td>6663944</td>\n",
       "      <td>Everton</td>\n",
       "      <td>nl NED</td>\n",
       "      <td>MF</td>\n",
       "      <td>24.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>483.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.18</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>601.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105</th>\n",
       "      <td>Dele Alli</td>\n",
       "      <td>100000</td>\n",
       "      <td>5553286</td>\n",
       "      <td>Everton</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>MF</td>\n",
       "      <td>25.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>338.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.11</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>349.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>135</th>\n",
       "      <td>Chris Wood</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>Burnley</td>\n",
       "      <td>nz NZL</td>\n",
       "      <td>FW</td>\n",
       "      <td>29.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0.31</td>\n",
       "      <td>38.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>-19.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>331.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>143</th>\n",
       "      <td>Moussa Sissoko</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>Watford</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>MF</td>\n",
       "      <td>31.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0.17</td>\n",
       "      <td>38.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>267.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>255</th>\n",
       "      <td>Daniel James</td>\n",
       "      <td>50000</td>\n",
       "      <td>2776643</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>wls WAL</td>\n",
       "      <td>FW</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>126.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.19</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>145.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>371</th>\n",
       "      <td>Anwar El Ghazi</td>\n",
       "      <td>30962</td>\n",
       "      <td>1719383</td>\n",
       "      <td>Everton</td>\n",
       "      <td>nl NED</td>\n",
       "      <td>FW</td>\n",
       "      <td>26.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>13.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6 rows × 41 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                Player  Weekly Salary  Annual Salary               Team  \\\n",
       "76   Donny van de Beek         120000        6663944            Everton   \n",
       "105          Dele Alli         100000        5553286            Everton   \n",
       "135         Chris Wood          80000        4442629            Burnley   \n",
       "143     Moussa Sissoko          80000        4442629            Watford   \n",
       "255       Daniel James          50000        2776643  Manchester United   \n",
       "371     Anwar El Ghazi          30962        1719383            Everton   \n",
       "\n",
       "      Nation Pos   Age    MP  Starts    Min  ...  npxG+xA.1  Played   Won  \\\n",
       "76    nl NED  MF  24.0   7.0     5.0  483.0  ...       0.18    38.0  11.0   \n",
       "105  eng ENG  MF  25.0  11.0     1.0  338.0  ...       0.11    38.0  11.0   \n",
       "135   nz NZL  FW  29.0  17.0    17.0    NaN  ...       0.31    38.0   7.0   \n",
       "143   fr FRA  MF  31.0  36.0    36.0    NaN  ...       0.17    38.0   6.0   \n",
       "255  wls WAL  FW  23.0   2.0     2.0  126.0  ...       0.19    38.0  16.0   \n",
       "371   nl NED  FW  26.0   2.0     0.0   13.0  ...       0.00    38.0  11.0   \n",
       "\n",
       "     Drawn  Lost  Goals For  Goals Against  Goal Difference  Points  \\\n",
       "76     6.0  21.0       43.0           66.0            -23.0    39.0   \n",
       "105    6.0  21.0       43.0           66.0            -23.0    39.0   \n",
       "135   14.0  17.0       34.0           53.0            -19.0    35.0   \n",
       "143    5.0  27.0       34.0           77.0            -43.0    23.0   \n",
       "255   10.0  12.0       57.0           57.0              0.0    58.0   \n",
       "371    6.0  21.0       43.0           66.0            -23.0    39.0   \n",
       "\n",
       "     performance_score  \n",
       "76               601.0  \n",
       "105              349.0  \n",
       "135              331.0  \n",
       "143              267.0  \n",
       "255              145.0  \n",
       "371               13.0  \n",
       "\n",
       "[6 rows x 41 columns]"
      ]
     },
     "execution_count": 166,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Weird process I was working on but ended up working out\n",
    "dupes_best = dupes.sort_values(\"performance_score\", ascending=False)\\\n",
    "                  .drop_duplicates(subset=\"Player\", keep=\"first\")\n",
    "dupes_best"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "id": "bd52fed2-6f97-4bb3-b9f7-3ede57771ec1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Position</th>\n",
       "      <th>Team</th>\n",
       "      <th>Nation</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Age</th>\n",
       "      <th>MP</th>\n",
       "      <th>Starts</th>\n",
       "      <th>...</th>\n",
       "      <th>npxG+xA.1</th>\n",
       "      <th>Played</th>\n",
       "      <th>Won</th>\n",
       "      <th>Drawn</th>\n",
       "      <th>Lost</th>\n",
       "      <th>Goals For</th>\n",
       "      <th>Goals Against</th>\n",
       "      <th>Goal Difference</th>\n",
       "      <th>Points</th>\n",
       "      <th>performance_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Cristiano Ronaldo</td>\n",
       "      <td>515000</td>\n",
       "      <td>28599424</td>\n",
       "      <td>F</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>pt POR</td>\n",
       "      <td>FW</td>\n",
       "      <td>36.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.64</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Kevin De Bruyne</td>\n",
       "      <td>400000</td>\n",
       "      <td>22213145</td>\n",
       "      <td>F</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>MF</td>\n",
       "      <td>30.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.65</td>\n",
       "      <td>38.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>David de Gea</td>\n",
       "      <td>375000</td>\n",
       "      <td>20824824</td>\n",
       "      <td>K</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>es ESP</td>\n",
       "      <td>GK</td>\n",
       "      <td>30.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Raphaël Varane</td>\n",
       "      <td>340000</td>\n",
       "      <td>18881173</td>\n",
       "      <td>D</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>DF</td>\n",
       "      <td>28.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.05</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Romelu Lukaku</td>\n",
       "      <td>325000</td>\n",
       "      <td>18048180</td>\n",
       "      <td>F</td>\n",
       "      <td>Chelsea</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>FW</td>\n",
       "      <td>28.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.51</td>\n",
       "      <td>38.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>476</th>\n",
       "      <td>Dele Alli</td>\n",
       "      <td>100000</td>\n",
       "      <td>5553286</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Everton</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>MF</td>\n",
       "      <td>25.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.11</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>349.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>477</th>\n",
       "      <td>Chris Wood</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Burnley</td>\n",
       "      <td>nz NZL</td>\n",
       "      <td>FW</td>\n",
       "      <td>29.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.31</td>\n",
       "      <td>38.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>-19.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>331.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>478</th>\n",
       "      <td>Moussa Sissoko</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Watford</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>MF</td>\n",
       "      <td>31.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.17</td>\n",
       "      <td>38.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>267.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>479</th>\n",
       "      <td>Daniel James</td>\n",
       "      <td>50000</td>\n",
       "      <td>2776643</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>wls WAL</td>\n",
       "      <td>FW</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.19</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>145.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>480</th>\n",
       "      <td>Anwar El Ghazi</td>\n",
       "      <td>30962</td>\n",
       "      <td>1719383</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Everton</td>\n",
       "      <td>nl NED</td>\n",
       "      <td>FW</td>\n",
       "      <td>26.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>13.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>481 rows × 42 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                Player  Weekly Salary  Annual Salary Position  \\\n",
       "0    Cristiano Ronaldo         515000       28599424        F   \n",
       "1      Kevin De Bruyne         400000       22213145        F   \n",
       "2         David de Gea         375000       20824824        K   \n",
       "3       Raphaël Varane         340000       18881173        D   \n",
       "4        Romelu Lukaku         325000       18048180        F   \n",
       "..                 ...            ...            ...      ...   \n",
       "476          Dele Alli         100000        5553286      NaN   \n",
       "477         Chris Wood          80000        4442629      NaN   \n",
       "478     Moussa Sissoko          80000        4442629      NaN   \n",
       "479       Daniel James          50000        2776643      NaN   \n",
       "480     Anwar El Ghazi          30962        1719383      NaN   \n",
       "\n",
       "                  Team   Nation Pos   Age    MP  Starts  ... npxG+xA.1  \\\n",
       "0    Manchester United   pt POR  FW  36.0  30.0    27.0  ...      0.64   \n",
       "1      Manchester City   be BEL  MF  30.0  30.0    25.0  ...      0.65   \n",
       "2    Manchester United   es ESP  GK  30.0  38.0    38.0  ...      0.00   \n",
       "3    Manchester United   fr FRA  DF  28.0  22.0    20.0  ...      0.05   \n",
       "4              Chelsea   be BEL  FW  28.0  26.0    16.0  ...      0.51   \n",
       "..                 ...      ...  ..   ...   ...     ...  ...       ...   \n",
       "476            Everton  eng ENG  MF  25.0  11.0     1.0  ...      0.11   \n",
       "477            Burnley   nz NZL  FW  29.0  17.0    17.0  ...      0.31   \n",
       "478            Watford   fr FRA  MF  31.0  36.0    36.0  ...      0.17   \n",
       "479  Manchester United  wls WAL  FW  23.0   2.0     2.0  ...      0.19   \n",
       "480            Everton   nl NED  FW  26.0   2.0     0.0  ...      0.00   \n",
       "\n",
       "     Played   Won  Drawn  Lost  Goals For  Goals Against  Goal Difference  \\\n",
       "0      38.0  16.0   10.0  12.0       57.0           57.0              0.0   \n",
       "1      38.0  29.0    6.0   3.0       99.0           26.0             73.0   \n",
       "2      38.0  16.0   10.0  12.0       57.0           57.0              0.0   \n",
       "3      38.0  16.0   10.0  12.0       57.0           57.0              0.0   \n",
       "4      38.0  21.0   11.0   6.0       76.0           33.0             43.0   \n",
       "..      ...   ...    ...   ...        ...            ...              ...   \n",
       "476    38.0  11.0    6.0  21.0       43.0           66.0            -23.0   \n",
       "477    38.0   7.0   14.0  17.0       34.0           53.0            -19.0   \n",
       "478    38.0   6.0    5.0  27.0       34.0           77.0            -43.0   \n",
       "479    38.0  16.0   10.0  12.0       57.0           57.0              0.0   \n",
       "480    38.0  11.0    6.0  21.0       43.0           66.0            -23.0   \n",
       "\n",
       "     Points  performance_score  \n",
       "0      58.0                NaN  \n",
       "1      93.0                NaN  \n",
       "2      58.0                NaN  \n",
       "3      58.0                NaN  \n",
       "4      74.0                NaN  \n",
       "..      ...                ...  \n",
       "476    39.0              349.0  \n",
       "477    35.0              331.0  \n",
       "478    23.0              267.0  \n",
       "479    58.0              145.0  \n",
       "480    39.0               13.0  \n",
       "\n",
       "[481 rows x 42 columns]"
      ]
     },
     "execution_count": 167,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_cleaned = merged_475[~merged_475[\"Player\"].isin(dupes[\"Player\"])]\n",
    "merged_cleaned = pd.concat([merged_cleaned, dupes_best], ignore_index=True)\n",
    "merged_cleaned"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 168,
   "id": "b905f277-a52b-4d99-adbd-6e9ac2b27d86",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Position</th>\n",
       "      <th>Team</th>\n",
       "      <th>Nation</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Age</th>\n",
       "      <th>MP</th>\n",
       "      <th>Starts</th>\n",
       "      <th>...</th>\n",
       "      <th>npxG+xA.1</th>\n",
       "      <th>Played</th>\n",
       "      <th>Won</th>\n",
       "      <th>Drawn</th>\n",
       "      <th>Lost</th>\n",
       "      <th>Goals For</th>\n",
       "      <th>Goals Against</th>\n",
       "      <th>Goal Difference</th>\n",
       "      <th>Points</th>\n",
       "      <th>Performance Score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Cristiano Ronaldo</td>\n",
       "      <td>515000</td>\n",
       "      <td>28599424</td>\n",
       "      <td>F</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>pt POR</td>\n",
       "      <td>FW</td>\n",
       "      <td>36.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.64</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>107.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Kevin De Bruyne</td>\n",
       "      <td>400000</td>\n",
       "      <td>22213145</td>\n",
       "      <td>F</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>MF</td>\n",
       "      <td>30.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.65</td>\n",
       "      <td>38.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>113.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>David de Gea</td>\n",
       "      <td>375000</td>\n",
       "      <td>20824824</td>\n",
       "      <td>K</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>es ESP</td>\n",
       "      <td>GK</td>\n",
       "      <td>30.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Raphaël Varane</td>\n",
       "      <td>340000</td>\n",
       "      <td>18881173</td>\n",
       "      <td>D</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>DF</td>\n",
       "      <td>28.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.05</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Romelu Lukaku</td>\n",
       "      <td>325000</td>\n",
       "      <td>18048180</td>\n",
       "      <td>F</td>\n",
       "      <td>Chelsea</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>FW</td>\n",
       "      <td>28.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.51</td>\n",
       "      <td>38.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>49.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>476</th>\n",
       "      <td>Dele Alli</td>\n",
       "      <td>100000</td>\n",
       "      <td>5553286</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Everton</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>MF</td>\n",
       "      <td>25.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.11</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>-2.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>477</th>\n",
       "      <td>Chris Wood</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Burnley</td>\n",
       "      <td>nz NZL</td>\n",
       "      <td>FW</td>\n",
       "      <td>29.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.31</td>\n",
       "      <td>38.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>-19.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>20.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>478</th>\n",
       "      <td>Moussa Sissoko</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Watford</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>MF</td>\n",
       "      <td>31.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.17</td>\n",
       "      <td>38.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>18.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>479</th>\n",
       "      <td>Daniel James</td>\n",
       "      <td>50000</td>\n",
       "      <td>2776643</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>wls WAL</td>\n",
       "      <td>FW</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.19</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>480</th>\n",
       "      <td>Anwar El Ghazi</td>\n",
       "      <td>30962</td>\n",
       "      <td>1719383</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Everton</td>\n",
       "      <td>nl NED</td>\n",
       "      <td>FW</td>\n",
       "      <td>26.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>481 rows × 42 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                Player  Weekly Salary  Annual Salary Position  \\\n",
       "0    Cristiano Ronaldo         515000       28599424        F   \n",
       "1      Kevin De Bruyne         400000       22213145        F   \n",
       "2         David de Gea         375000       20824824        K   \n",
       "3       Raphaël Varane         340000       18881173        D   \n",
       "4        Romelu Lukaku         325000       18048180        F   \n",
       "..                 ...            ...            ...      ...   \n",
       "476          Dele Alli         100000        5553286      NaN   \n",
       "477         Chris Wood          80000        4442629      NaN   \n",
       "478     Moussa Sissoko          80000        4442629      NaN   \n",
       "479       Daniel James          50000        2776643      NaN   \n",
       "480     Anwar El Ghazi          30962        1719383      NaN   \n",
       "\n",
       "                  Team   Nation Pos   Age    MP  Starts  ... npxG+xA.1  \\\n",
       "0    Manchester United   pt POR  FW  36.0  30.0    27.0  ...      0.64   \n",
       "1      Manchester City   be BEL  MF  30.0  30.0    25.0  ...      0.65   \n",
       "2    Manchester United   es ESP  GK  30.0  38.0    38.0  ...      0.00   \n",
       "3    Manchester United   fr FRA  DF  28.0  22.0    20.0  ...      0.05   \n",
       "4              Chelsea   be BEL  FW  28.0  26.0    16.0  ...      0.51   \n",
       "..                 ...      ...  ..   ...   ...     ...  ...       ...   \n",
       "476            Everton  eng ENG  MF  25.0  11.0     1.0  ...      0.11   \n",
       "477            Burnley   nz NZL  FW  29.0  17.0    17.0  ...      0.31   \n",
       "478            Watford   fr FRA  MF  31.0  36.0    36.0  ...      0.17   \n",
       "479  Manchester United  wls WAL  FW  23.0   2.0     2.0  ...      0.19   \n",
       "480            Everton   nl NED  FW  26.0   2.0     0.0  ...      0.00   \n",
       "\n",
       "     Played   Won  Drawn  Lost  Goals For  Goals Against  Goal Difference  \\\n",
       "0      38.0  16.0   10.0  12.0       57.0           57.0              0.0   \n",
       "1      38.0  29.0    6.0   3.0       99.0           26.0             73.0   \n",
       "2      38.0  16.0   10.0  12.0       57.0           57.0              0.0   \n",
       "3      38.0  16.0   10.0  12.0       57.0           57.0              0.0   \n",
       "4      38.0  21.0   11.0   6.0       76.0           33.0             43.0   \n",
       "..      ...   ...    ...   ...        ...            ...              ...   \n",
       "476    38.0  11.0    6.0  21.0       43.0           66.0            -23.0   \n",
       "477    38.0   7.0   14.0  17.0       34.0           53.0            -19.0   \n",
       "478    38.0   6.0    5.0  27.0       34.0           77.0            -43.0   \n",
       "479    38.0  16.0   10.0  12.0       57.0           57.0              0.0   \n",
       "480    38.0  11.0    6.0  21.0       43.0           66.0            -23.0   \n",
       "\n",
       "     Points  Performance Score  \n",
       "0      58.0              107.6  \n",
       "1      93.0              113.8  \n",
       "2      58.0                0.0  \n",
       "3      58.0                9.0  \n",
       "4      74.0               49.2  \n",
       "..      ...                ...  \n",
       "476    39.0               -2.2  \n",
       "477    35.0               20.4  \n",
       "478    23.0               18.4  \n",
       "479    58.0                0.4  \n",
       "480    39.0                0.0  \n",
       "\n",
       "[481 rows x 42 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We decided to create a performance score column for the purpose of further analysis in regarding how well the players preform \n",
    "#in an offessive manner. This takes into an account goals, assist, non penalty goals, expected assists, yellow and red cards. \n",
    "#The variables are marked and weighted according to importance with negative variables substracting to overall performance.\n",
    "merged_cleaned['Performance Score'] = (\n",
    "    merged_cleaned['Gls'] * 4 +\n",
    "    merged_cleaned['Ast'] * 3 +\n",
    "    merged_cleaned['npxG'] * 2 +\n",
    "    merged_cleaned['xA'] * 2 -\n",
    "    merged_cleaned['CrdY'] * 1 -\n",
    "    merged_cleaned['CrdR'] * 3\n",
    ")\n",
    "merged_cleaned = merged_cleaned.drop('performance_score', axis =1)\n",
    "display(merged_cleaned)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "id": "dcc543a9-2d43-4d79-9df8-4fc3e0381d8d",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['Player', 'Weekly Salary', 'Annual Salary', 'Position', 'Team', 'Nation', 'Pos', 'Age', 'MP', 'Starts', 'Min', '90s', 'Gls', 'Ast', 'G-PK', 'PK', 'PKatt', 'CrdY', 'CrdR', 'Gls.1', 'Ast.1', 'G+A', 'G-PK.1', 'G+A-PK', 'xG', 'npxG', 'xA', 'npxG+xA', 'xG.1', 'xA.1', 'xG+xA', 'npxG.1', 'npxG+xA.1', 'Played', 'Won', 'Drawn', 'Lost', 'Goals For', 'Goals Against', 'Goal Difference', 'Points', 'Performance Score']\n"
     ]
    }
   ],
   "source": [
    "#Checking the columns\n",
    "print(merged_cleaned.columns.tolist())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "id": "998dbd8d-7c57-4e2e-97a9-5a96b246432b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Drop the 'Position' column if it exists\n",
    "if 'Position' in merged_cleaned.columns:\n",
    "    merged_cleaned = merged_cleaned.drop(columns=['Position'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "id": "2319fa08-1f87-490d-ae23-99e2d1d238ef",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Team</th>\n",
       "      <th>Nation</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Age</th>\n",
       "      <th>MP</th>\n",
       "      <th>Starts</th>\n",
       "      <th>Min</th>\n",
       "      <th>...</th>\n",
       "      <th>npxG+xA.1</th>\n",
       "      <th>Played</th>\n",
       "      <th>Won</th>\n",
       "      <th>Drawn</th>\n",
       "      <th>Lost</th>\n",
       "      <th>Goals For</th>\n",
       "      <th>Goals Against</th>\n",
       "      <th>Goal Difference</th>\n",
       "      <th>Points</th>\n",
       "      <th>Performance Score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Cristiano Ronaldo</td>\n",
       "      <td>515000</td>\n",
       "      <td>28599424</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>pt POR</td>\n",
       "      <td>FW</td>\n",
       "      <td>36.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>2,456</td>\n",
       "      <td>...</td>\n",
       "      <td>0.64</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>107.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Kevin De Bruyne</td>\n",
       "      <td>400000</td>\n",
       "      <td>22213145</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>MF</td>\n",
       "      <td>30.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>2,201</td>\n",
       "      <td>...</td>\n",
       "      <td>0.65</td>\n",
       "      <td>38.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>113.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Romelu Lukaku</td>\n",
       "      <td>325000</td>\n",
       "      <td>18048180</td>\n",
       "      <td>Chelsea</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>FW</td>\n",
       "      <td>28.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>1,589</td>\n",
       "      <td>...</td>\n",
       "      <td>0.51</td>\n",
       "      <td>38.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>49.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Jack Grealish</td>\n",
       "      <td>300000</td>\n",
       "      <td>16659859</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>FW</td>\n",
       "      <td>25.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1,914</td>\n",
       "      <td>...</td>\n",
       "      <td>0.52</td>\n",
       "      <td>38.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>40.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Raheem Sterling</td>\n",
       "      <td>300000</td>\n",
       "      <td>16659859</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>FW</td>\n",
       "      <td>26.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2,128</td>\n",
       "      <td>...</td>\n",
       "      <td>0.70</td>\n",
       "      <td>38.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>99.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>192</th>\n",
       "      <td>Dele Alli</td>\n",
       "      <td>100000</td>\n",
       "      <td>5553286</td>\n",
       "      <td>Everton</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>MF</td>\n",
       "      <td>25.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>338.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.11</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>-2.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>193</th>\n",
       "      <td>Chris Wood</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>Burnley</td>\n",
       "      <td>nz NZL</td>\n",
       "      <td>FW</td>\n",
       "      <td>29.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0.31</td>\n",
       "      <td>38.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>-19.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>20.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>194</th>\n",
       "      <td>Moussa Sissoko</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>Watford</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>MF</td>\n",
       "      <td>31.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0.17</td>\n",
       "      <td>38.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>18.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>195</th>\n",
       "      <td>Daniel James</td>\n",
       "      <td>50000</td>\n",
       "      <td>2776643</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>wls WAL</td>\n",
       "      <td>FW</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>126.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.19</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>196</th>\n",
       "      <td>Anwar El Ghazi</td>\n",
       "      <td>30962</td>\n",
       "      <td>1719383</td>\n",
       "      <td>Everton</td>\n",
       "      <td>nl NED</td>\n",
       "      <td>FW</td>\n",
       "      <td>26.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>38.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>197 rows × 41 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                Player  Weekly Salary  Annual Salary               Team  \\\n",
       "0    Cristiano Ronaldo         515000       28599424  Manchester United   \n",
       "1      Kevin De Bruyne         400000       22213145    Manchester City   \n",
       "2        Romelu Lukaku         325000       18048180            Chelsea   \n",
       "3        Jack Grealish         300000       16659859    Manchester City   \n",
       "4      Raheem Sterling         300000       16659859    Manchester City   \n",
       "..                 ...            ...            ...                ...   \n",
       "192          Dele Alli         100000        5553286            Everton   \n",
       "193         Chris Wood          80000        4442629            Burnley   \n",
       "194     Moussa Sissoko          80000        4442629            Watford   \n",
       "195       Daniel James          50000        2776643  Manchester United   \n",
       "196     Anwar El Ghazi          30962        1719383            Everton   \n",
       "\n",
       "      Nation Pos   Age    MP  Starts    Min  ...  npxG+xA.1  Played   Won  \\\n",
       "0     pt POR  FW  36.0  30.0    27.0  2,456  ...       0.64    38.0  16.0   \n",
       "1     be BEL  MF  30.0  30.0    25.0  2,201  ...       0.65    38.0  29.0   \n",
       "2     be BEL  FW  28.0  26.0    16.0  1,589  ...       0.51    38.0  21.0   \n",
       "3    eng ENG  FW  25.0  26.0    22.0  1,914  ...       0.52    38.0  29.0   \n",
       "4    eng ENG  FW  26.0  30.0    23.0  2,128  ...       0.70    38.0  29.0   \n",
       "..       ...  ..   ...   ...     ...    ...  ...        ...     ...   ...   \n",
       "192  eng ENG  MF  25.0  11.0     1.0  338.0  ...       0.11    38.0  11.0   \n",
       "193   nz NZL  FW  29.0  17.0    17.0    NaN  ...       0.31    38.0   7.0   \n",
       "194   fr FRA  MF  31.0  36.0    36.0    NaN  ...       0.17    38.0   6.0   \n",
       "195  wls WAL  FW  23.0   2.0     2.0  126.0  ...       0.19    38.0  16.0   \n",
       "196   nl NED  FW  26.0   2.0     0.0   13.0  ...       0.00    38.0  11.0   \n",
       "\n",
       "     Drawn  Lost  Goals For  Goals Against  Goal Difference  Points  \\\n",
       "0     10.0  12.0       57.0           57.0              0.0    58.0   \n",
       "1      6.0   3.0       99.0           26.0             73.0    93.0   \n",
       "2     11.0   6.0       76.0           33.0             43.0    74.0   \n",
       "3      6.0   3.0       99.0           26.0             73.0    93.0   \n",
       "4      6.0   3.0       99.0           26.0             73.0    93.0   \n",
       "..     ...   ...        ...            ...              ...     ...   \n",
       "192    6.0  21.0       43.0           66.0            -23.0    39.0   \n",
       "193   14.0  17.0       34.0           53.0            -19.0    35.0   \n",
       "194    5.0  27.0       34.0           77.0            -43.0    23.0   \n",
       "195   10.0  12.0       57.0           57.0              0.0    58.0   \n",
       "196    6.0  21.0       43.0           66.0            -23.0    39.0   \n",
       "\n",
       "     Performance Score  \n",
       "0                107.6  \n",
       "1                113.8  \n",
       "2                 49.2  \n",
       "3                 40.2  \n",
       "4                 99.2  \n",
       "..                 ...  \n",
       "192               -2.2  \n",
       "193               20.4  \n",
       "194               18.4  \n",
       "195                0.4  \n",
       "196                0.0  \n",
       "\n",
       "[197 rows x 41 columns]"
      ]
     },
     "execution_count": 171,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Keep only 'FW' and 'MF' in the 'Pos' column\n",
    "merged_cleaned = merged_cleaned[merged_cleaned[\"Pos\"].isin(['FW', 'MF', 'MF,FW', 'FW,MF'])]\n",
    "merged_cleaned = merged_cleaned.reset_index(drop=True)\n",
    "merged_cleaned"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "id": "3c1b1dde-0205-44d4-83a1-c7fda0e1e7d5",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Team</th>\n",
       "      <th>Nation</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Age</th>\n",
       "      <th>MP</th>\n",
       "      <th>Starts</th>\n",
       "      <th>Min</th>\n",
       "      <th>...</th>\n",
       "      <th>npxG+xA.1</th>\n",
       "      <th>Played</th>\n",
       "      <th>Won</th>\n",
       "      <th>Drawn</th>\n",
       "      <th>Lost</th>\n",
       "      <th>Goals For</th>\n",
       "      <th>Goals Against</th>\n",
       "      <th>Goal Difference</th>\n",
       "      <th>Points</th>\n",
       "      <th>Performance Score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>54</th>\n",
       "      <td>Adam Lallana</td>\n",
       "      <td>90000</td>\n",
       "      <td>4997958</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>MF</td>\n",
       "      <td>33.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>1,561</td>\n",
       "      <td>...</td>\n",
       "      <td>0.11</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>108</th>\n",
       "      <td>Danny Welbeck</td>\n",
       "      <td>55000</td>\n",
       "      <td>3054307</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>FW</td>\n",
       "      <td>30.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>1,478</td>\n",
       "      <td>...</td>\n",
       "      <td>0.44</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>44.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>128</th>\n",
       "      <td>Jürgen Locadia</td>\n",
       "      <td>45000</td>\n",
       "      <td>2498979</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>nl NED</td>\n",
       "      <td>FW</td>\n",
       "      <td>27.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>23</td>\n",
       "      <td>...</td>\n",
       "      <td>0.45</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>137</th>\n",
       "      <td>Leandro Trossard</td>\n",
       "      <td>40000</td>\n",
       "      <td>2221315</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>FW,MF</td>\n",
       "      <td>26.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>2,805</td>\n",
       "      <td>...</td>\n",
       "      <td>0.32</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148</th>\n",
       "      <td>Neal Maupay</td>\n",
       "      <td>35000</td>\n",
       "      <td>1943650</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>FW</td>\n",
       "      <td>24.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>2,276</td>\n",
       "      <td>...</td>\n",
       "      <td>0.33</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>47.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>156</th>\n",
       "      <td>Enock Mwepu</td>\n",
       "      <td>30769</td>\n",
       "      <td>1708703</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>zm ZAM</td>\n",
       "      <td>MF,FW</td>\n",
       "      <td>23.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>996</td>\n",
       "      <td>...</td>\n",
       "      <td>0.29</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>24.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>157</th>\n",
       "      <td>Alexis Mac Allister</td>\n",
       "      <td>30000</td>\n",
       "      <td>1665986</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>ar ARG</td>\n",
       "      <td>MF,FW</td>\n",
       "      <td>22.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>2,123</td>\n",
       "      <td>...</td>\n",
       "      <td>0.24</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>33.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>165</th>\n",
       "      <td>Amad Diallo</td>\n",
       "      <td>28846</td>\n",
       "      <td>1601910</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>ci CIV</td>\n",
       "      <td>FW</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>173</th>\n",
       "      <td>Yves Bissouma</td>\n",
       "      <td>25000</td>\n",
       "      <td>1388322</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>ml MLI</td>\n",
       "      <td>MF</td>\n",
       "      <td>24.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>2,111</td>\n",
       "      <td>...</td>\n",
       "      <td>0.07</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>174</th>\n",
       "      <td>Aaron Connolly</td>\n",
       "      <td>23077</td>\n",
       "      <td>1281528</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>ie IRL</td>\n",
       "      <td>FW</td>\n",
       "      <td>21.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>156</td>\n",
       "      <td>...</td>\n",
       "      <td>0.47</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>185</th>\n",
       "      <td>Taylor Richards</td>\n",
       "      <td>15000</td>\n",
       "      <td>832993</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>MF,FW</td>\n",
       "      <td>20.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>25</td>\n",
       "      <td>...</td>\n",
       "      <td>0.14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>186</th>\n",
       "      <td>Steven Alzate</td>\n",
       "      <td>15000</td>\n",
       "      <td>832993</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>co COL</td>\n",
       "      <td>MF</td>\n",
       "      <td>22.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>404</td>\n",
       "      <td>...</td>\n",
       "      <td>0.06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>187</th>\n",
       "      <td>Moisés Caicedo</td>\n",
       "      <td>15000</td>\n",
       "      <td>832993</td>\n",
       "      <td>Brighton &amp; Hove Albion</td>\n",
       "      <td>ec ECU</td>\n",
       "      <td>MF</td>\n",
       "      <td>19.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>660</td>\n",
       "      <td>...</td>\n",
       "      <td>0.16</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>193</th>\n",
       "      <td>Chris Wood</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>Burnley</td>\n",
       "      <td>nz NZL</td>\n",
       "      <td>FW</td>\n",
       "      <td>29.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0.31</td>\n",
       "      <td>38.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>-19.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>20.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>194</th>\n",
       "      <td>Moussa Sissoko</td>\n",
       "      <td>80000</td>\n",
       "      <td>4442629</td>\n",
       "      <td>Watford</td>\n",
       "      <td>fr FRA</td>\n",
       "      <td>MF</td>\n",
       "      <td>31.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0.17</td>\n",
       "      <td>38.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>18.4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>15 rows × 41 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  Player  Weekly Salary  Annual Salary  \\\n",
       "54          Adam Lallana          90000        4997958   \n",
       "108        Danny Welbeck          55000        3054307   \n",
       "128       Jürgen Locadia          45000        2498979   \n",
       "137     Leandro Trossard          40000        2221315   \n",
       "148          Neal Maupay          35000        1943650   \n",
       "156          Enock Mwepu          30769        1708703   \n",
       "157  Alexis Mac Allister          30000        1665986   \n",
       "165          Amad Diallo          28846        1601910   \n",
       "173        Yves Bissouma          25000        1388322   \n",
       "174       Aaron Connolly          23077        1281528   \n",
       "185      Taylor Richards          15000         832993   \n",
       "186        Steven Alzate          15000         832993   \n",
       "187       Moisés Caicedo          15000         832993   \n",
       "193           Chris Wood          80000        4442629   \n",
       "194       Moussa Sissoko          80000        4442629   \n",
       "\n",
       "                       Team   Nation    Pos   Age    MP  Starts    Min  ...  \\\n",
       "54   Brighton & Hove Albion  eng ENG     MF  33.0  24.0    18.0  1,561  ...   \n",
       "108  Brighton & Hove Albion  eng ENG     FW  30.0  25.0    15.0  1,478  ...   \n",
       "128  Brighton & Hove Albion   nl NED     FW  27.0   1.0     0.0     23  ...   \n",
       "137  Brighton & Hove Albion   be BEL  FW,MF  26.0  34.0    32.0  2,805  ...   \n",
       "148  Brighton & Hove Albion   fr FRA     FW  24.0  32.0    25.0  2,276  ...   \n",
       "156  Brighton & Hove Albion   zm ZAM  MF,FW  23.0  18.0    12.0    996  ...   \n",
       "157  Brighton & Hove Albion   ar ARG  MF,FW  22.0  33.0    22.0  2,123  ...   \n",
       "165       Manchester United   ci CIV     FW  19.0   0.0     0.0    NaN  ...   \n",
       "173  Brighton & Hove Albion   ml MLI     MF  24.0  26.0    25.0  2,111  ...   \n",
       "174  Brighton & Hove Albion   ie IRL     FW  21.0   4.0     1.0    156  ...   \n",
       "185  Brighton & Hove Albion  eng ENG  MF,FW  20.0   2.0     0.0     25  ...   \n",
       "186  Brighton & Hove Albion   co COL     MF  22.0   9.0     5.0    404  ...   \n",
       "187  Brighton & Hove Albion   ec ECU     MF  19.0   8.0     8.0    660  ...   \n",
       "193                 Burnley   nz NZL     FW  29.0  17.0    17.0    NaN  ...   \n",
       "194                 Watford   fr FRA     MF  31.0  36.0    36.0    NaN  ...   \n",
       "\n",
       "     npxG+xA.1  Played   Won  Drawn  Lost  Goals For  Goals Against  \\\n",
       "54        0.11     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "108       0.44     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "128       0.45     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "137       0.32     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "148       0.33     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "156       0.29     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "157       0.24     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "165        NaN    38.0  16.0   10.0  12.0       57.0           57.0   \n",
       "173       0.07     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "174       0.47     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "185       0.14     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "186       0.06     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "187       0.16     NaN   NaN    NaN   NaN        NaN            NaN   \n",
       "193       0.31    38.0   7.0   14.0  17.0       34.0           53.0   \n",
       "194       0.17    38.0   6.0    5.0  27.0       34.0           77.0   \n",
       "\n",
       "     Goal Difference  Points  Performance Score  \n",
       "54               NaN     NaN                2.8  \n",
       "108              NaN     NaN               44.2  \n",
       "128              NaN     NaN                0.2  \n",
       "137              NaN     NaN               59.2  \n",
       "148              NaN     NaN               47.8  \n",
       "156              NaN     NaN               24.6  \n",
       "157              NaN     NaN               33.4  \n",
       "165              0.0    58.0                NaN  \n",
       "173              NaN     NaN                3.4  \n",
       "174              NaN     NaN                1.8  \n",
       "185              NaN     NaN                0.0  \n",
       "186              NaN     NaN                0.6  \n",
       "187              NaN     NaN                7.4  \n",
       "193            -19.0    35.0               20.4  \n",
       "194            -43.0    23.0               18.4  \n",
       "\n",
       "[15 rows x 41 columns]"
      ]
     },
     "execution_count": 172,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Checking for nan values in the rows\n",
    "nan_rows = merged_cleaned[merged_cleaned.isna().any(axis=1)]\n",
    "nan_rows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 173,
   "id": "5c69beb0-9fc0-41bd-a245-570ff09e1e8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Drop rows with any NaN values\n",
    "merged_cleaned = merged_cleaned.dropna()\n",
    "merged_cleaned = merged_cleaned.reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 235,
   "id": "18b640e3-514f-4797-8788-fcfaaa8e49b5",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Calculate Performance per £1k\n",
    "merged_cleaned['Goals_per_1k'] = merged_cleaned['Gls'] / (merged_cleaned['Annual Salary'] / 1000)\n",
    "merged_cleaned['xG_per_1k'] = merged_cleaned['xG'] / (merged_cleaned['Annual Salary'] / 1000)\n",
    "merged_cleaned['Assists_per_1k'] = merged_cleaned['Ast'] / (merged_cleaned['Annual Salary'] / 1000)\n",
    "merged_cleaned['G+A_per_1k'] = merged_cleaned['G+A'] / (merged_cleaned['Annual Salary'] / 1000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 241,
   "id": "7ac3813b-ada4-45e7-9f36-057fc87ad94f",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Clean the data again by removing commas and converting to numeric\n",
    "for col in ['Min', 'xG', 'G+A', 'Annual Salary']:\n",
    "    merged_cleaned[col] = merged_cleaned[col].astype(str).str.replace(',', '')\n",
    "    merged_cleaned[col] = pd.to_numeric(merged_cleaned[col], errors='coerce')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 247,
   "id": "ae092976-2c8e-4629-bb12-0bf7fa85f501",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Player</th>\n",
       "      <th>Weekly Salary</th>\n",
       "      <th>Annual Salary</th>\n",
       "      <th>Team</th>\n",
       "      <th>Nation</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Age</th>\n",
       "      <th>MP</th>\n",
       "      <th>Starts</th>\n",
       "      <th>Min</th>\n",
       "      <th>...</th>\n",
       "      <th>Lost</th>\n",
       "      <th>Goals For</th>\n",
       "      <th>Goals Against</th>\n",
       "      <th>Goal Difference</th>\n",
       "      <th>Points</th>\n",
       "      <th>Performance Score</th>\n",
       "      <th>Goals_per_1k</th>\n",
       "      <th>xG_per_1k</th>\n",
       "      <th>Assists_per_1k</th>\n",
       "      <th>G+A_per_1k</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Cristiano Ronaldo</td>\n",
       "      <td>515000</td>\n",
       "      <td>28599424</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>pt POR</td>\n",
       "      <td>FW</td>\n",
       "      <td>36.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>2456.0</td>\n",
       "      <td>...</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>107.6</td>\n",
       "      <td>0.000629</td>\n",
       "      <td>0.000577</td>\n",
       "      <td>0.000105</td>\n",
       "      <td>0.000027</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Kevin De Bruyne</td>\n",
       "      <td>400000</td>\n",
       "      <td>22213145</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>MF</td>\n",
       "      <td>30.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>2201.0</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>113.8</td>\n",
       "      <td>0.000675</td>\n",
       "      <td>0.000288</td>\n",
       "      <td>0.000360</td>\n",
       "      <td>0.000042</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Romelu Lukaku</td>\n",
       "      <td>325000</td>\n",
       "      <td>18048180</td>\n",
       "      <td>Chelsea</td>\n",
       "      <td>be BEL</td>\n",
       "      <td>FW</td>\n",
       "      <td>28.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>1589.0</td>\n",
       "      <td>...</td>\n",
       "      <td>6.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>49.2</td>\n",
       "      <td>0.000443</td>\n",
       "      <td>0.000377</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Jack Grealish</td>\n",
       "      <td>300000</td>\n",
       "      <td>16659859</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>FW</td>\n",
       "      <td>25.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1914.0</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>40.2</td>\n",
       "      <td>0.000180</td>\n",
       "      <td>0.000288</td>\n",
       "      <td>0.000180</td>\n",
       "      <td>0.000017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Raheem Sterling</td>\n",
       "      <td>300000</td>\n",
       "      <td>16659859</td>\n",
       "      <td>Manchester City</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>FW</td>\n",
       "      <td>26.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2128.0</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>99.2</td>\n",
       "      <td>0.000780</td>\n",
       "      <td>0.000864</td>\n",
       "      <td>0.000300</td>\n",
       "      <td>0.000046</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>177</th>\n",
       "      <td>Ken Sema</td>\n",
       "      <td>15000</td>\n",
       "      <td>832993</td>\n",
       "      <td>Watford</td>\n",
       "      <td>se SWE</td>\n",
       "      <td>MF,FW</td>\n",
       "      <td>27.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>852.0</td>\n",
       "      <td>...</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-43.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>1.8</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000240</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>178</th>\n",
       "      <td>Donny van de Beek</td>\n",
       "      <td>120000</td>\n",
       "      <td>6663944</td>\n",
       "      <td>Everton</td>\n",
       "      <td>nl NED</td>\n",
       "      <td>MF</td>\n",
       "      <td>24.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>483.0</td>\n",
       "      <td>...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.000150</td>\n",
       "      <td>0.000135</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000029</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>179</th>\n",
       "      <td>Dele Alli</td>\n",
       "      <td>100000</td>\n",
       "      <td>5553286</td>\n",
       "      <td>Everton</td>\n",
       "      <td>eng ENG</td>\n",
       "      <td>MF</td>\n",
       "      <td>25.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>338.0</td>\n",
       "      <td>...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>-2.2</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000018</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>180</th>\n",
       "      <td>Daniel James</td>\n",
       "      <td>50000</td>\n",
       "      <td>2776643</td>\n",
       "      <td>Manchester United</td>\n",
       "      <td>wls WAL</td>\n",
       "      <td>FW</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>126.0</td>\n",
       "      <td>...</td>\n",
       "      <td>12.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.4</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000072</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>181</th>\n",
       "      <td>Anwar El Ghazi</td>\n",
       "      <td>30962</td>\n",
       "      <td>1719383</td>\n",
       "      <td>Everton</td>\n",
       "      <td>nl NED</td>\n",
       "      <td>FW</td>\n",
       "      <td>26.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>-23.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>182 rows × 45 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                Player  Weekly Salary  Annual Salary               Team  \\\n",
       "0    Cristiano Ronaldo         515000       28599424  Manchester United   \n",
       "1      Kevin De Bruyne         400000       22213145    Manchester City   \n",
       "2        Romelu Lukaku         325000       18048180            Chelsea   \n",
       "3        Jack Grealish         300000       16659859    Manchester City   \n",
       "4      Raheem Sterling         300000       16659859    Manchester City   \n",
       "..                 ...            ...            ...                ...   \n",
       "177           Ken Sema          15000         832993            Watford   \n",
       "178  Donny van de Beek         120000        6663944            Everton   \n",
       "179          Dele Alli         100000        5553286            Everton   \n",
       "180       Daniel James          50000        2776643  Manchester United   \n",
       "181     Anwar El Ghazi          30962        1719383            Everton   \n",
       "\n",
       "      Nation    Pos   Age    MP  Starts     Min  ...  Lost  Goals For  \\\n",
       "0     pt POR     FW  36.0  30.0    27.0  2456.0  ...  12.0       57.0   \n",
       "1     be BEL     MF  30.0  30.0    25.0  2201.0  ...   3.0       99.0   \n",
       "2     be BEL     FW  28.0  26.0    16.0  1589.0  ...   6.0       76.0   \n",
       "3    eng ENG     FW  25.0  26.0    22.0  1914.0  ...   3.0       99.0   \n",
       "4    eng ENG     FW  26.0  30.0    23.0  2128.0  ...   3.0       99.0   \n",
       "..       ...    ...   ...   ...     ...     ...  ...   ...        ...   \n",
       "177   se SWE  MF,FW  27.0  18.0     7.0   852.0  ...  27.0       34.0   \n",
       "178   nl NED     MF  24.0   7.0     5.0   483.0  ...  21.0       43.0   \n",
       "179  eng ENG     MF  25.0  11.0     1.0   338.0  ...  21.0       43.0   \n",
       "180  wls WAL     FW  23.0   2.0     2.0   126.0  ...  12.0       57.0   \n",
       "181   nl NED     FW  26.0   2.0     0.0    13.0  ...  21.0       43.0   \n",
       "\n",
       "     Goals Against  Goal Difference  Points  Performance Score  Goals_per_1k  \\\n",
       "0             57.0              0.0    58.0              107.6      0.000629   \n",
       "1             26.0             73.0    93.0              113.8      0.000675   \n",
       "2             33.0             43.0    74.0               49.2      0.000443   \n",
       "3             26.0             73.0    93.0               40.2      0.000180   \n",
       "4             26.0             73.0    93.0               99.2      0.000780   \n",
       "..             ...              ...     ...                ...           ...   \n",
       "177           77.0            -43.0    23.0                1.8      0.000000   \n",
       "178           66.0            -23.0    39.0                5.0      0.000150   \n",
       "179           66.0            -23.0    39.0               -2.2      0.000000   \n",
       "180           57.0              0.0    58.0                0.4      0.000000   \n",
       "181           66.0            -23.0    39.0                0.0      0.000000   \n",
       "\n",
       "     xG_per_1k  Assists_per_1k  G+A_per_1k  \n",
       "0     0.000577        0.000105    0.000027  \n",
       "1     0.000288        0.000360    0.000042  \n",
       "2     0.000377        0.000000    0.000025  \n",
       "3     0.000288        0.000180    0.000017  \n",
       "4     0.000864        0.000300    0.000046  \n",
       "..         ...             ...         ...  \n",
       "177   0.000240        0.000000    0.000000  \n",
       "178   0.000135        0.000000    0.000029  \n",
       "179   0.000018        0.000000    0.000000  \n",
       "180   0.000072        0.000000    0.000000  \n",
       "181   0.000000        0.000000    0.000000  \n",
       "\n",
       "[182 rows x 45 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(merged_cleaned)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
